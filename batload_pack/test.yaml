sensor:
  - platform: template
    name: currentforset
    id: currentforset 
    lambda: !lambda |-
      if (id(currentset).state + (id(powerinout).state / id(actualvoltage).state) <= 0) {
        return 0;
      if (id(currentset).state + (id(powerinout).state / id(actualvoltage).state) >= id(maxloadcurrent).state) {
        return id(maxloadcurrent).state;
      if (id(batvoltage).state <= 24.5) and (id(currentset).state + (id(powerinout).state / id(actualvoltage).state) <= 0) {
        return 0.5;
      } else {
        return id(currentset).state + (id(powerinout).state / id(actualvoltage).state;
      }
    update_interval: 1s
    unit_of_measurement: "Ampere"
    accuracy_decimals: 2
   # filters:
   #  - multiply: 1
    on_value:
       then:
         - number.set:
             id: currentset
             value: !lambda |-
                return id(currentset1).state;
         
